version: "2"
output:
  formats:
    text:
      path: stdout
      color: true
linters:
  enable:
    # Default linters plus these:
    - bodyclose
    - copyloopvar
    - durationcheck
    - errname
    - errorlint
    - exhaustive
    - gochecknoglobals
    - gochecknoinits
    - gocognit
    - goconst
    - gocritic
    - gosec
    - ireturn
    - makezero
    - misspell
    - mnd
    - nakedret
    - nilerr
    - noctx
    - nolintlint
    - paralleltest
    - revive
    - unconvert
    - unparam
  settings:
    ireturn:
      allow:
        # Defaults:
        - anon
        - error
        - empty
        - generic
        - stdlib
        # Also allow these common interfaces:
        - github\.com\/go-git\/go-billy\/v5
        - golang\.org\/x\/tools\/godoc\/vfs
        - github\.com\/hack-pad\/hackpadfs\.FS
  exclusions:
    generated: lax
    presets:
      - common-false-positives
      - legacy
      - std-error-handling
    rules:
      # Pipes are best used as pre-compiled globals, much like regexp.Mustcompile()
      - linters:
          - gochecknoglobals
        text: .*Pipe is a global variable
      # Reflection is slow, so some global reflect types are ok
      - linters:
          - gochecknoglobals
        text: .*Type is a global variable
        source: .*Type *= *reflect.TypeOf\(.*
      # False positive for paralleltest usage detection
      - linters:
          - paralleltest
        text: Range statement for test Test.* does not use range value in test Run
    paths:
      - third_party$
      - builtin$
      - examples$
formatters:
  enable:
    - gofmt
  exclusions:
    generated: lax
    paths:
      - third_party$
      - builtin$
      - examples$
